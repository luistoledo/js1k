u=g=null,M=Math,B=M.abs,R=M.random,c.scale(9,9),W=c.canvas.width/9,H=c.canvas.height/9,k=[],t=[],e=[],f=j=z=mb=X=Y=0,O=function(e,n,t,o,c){return{x:e||R()*W,y:n||R()*H,a:t||0,L:o||0,E:c||0}},p=O(W/2,H/2,g,"#0f0"),p.h=10,D=function(o,i){with(o)E?(R()<.05&&(a=A(o,p)),t.forEach(function(n){C(n,o)&&(e.splice(i,1),z++,j="#fff",f=3)}),C(p,o)&&(p.h--,j="red",f=4)):(W-x<1||H-y<1)&&t.splice(i,1),a&&(x-=M.cos(a),y-=M.sin(a)),c.fillStyle=o.L,c.fillRect(x,y,1,1)},A=function(e,n){return M.atan2(e.y-n.y,e.x-n.x)},C=function(e,n){return B(e.x-n.x)+B(e.y-n.y)<2},G=function(){return c.fillStyle=j,c.fillRect(0,0,W,H),j="#fde",t.forEach(D),c.fillText("k:"+z+" h:"+p.h,0,9),p.h<1?void v.stop(1):(v.frequency.setValueAtTime(100*f,S.currentTime),f=0,mb&&R()>.8&&(t.push(O(p.x,p.y,A(p,O(X,Y)),"Tan",0)),f=2),Date.now()%45<1&&e.push(O(g,g,g,"red",1)),R()>.99&&(u=O(g,g,g,"#000")),u&&(D(u),C(p,u)&&(u=g,z+=e.length,e=[],j="#fff",f=9)),e.forEach(D),p.y+=.5*(k[83]|0-k[87]|0),p.x+=.5*(k[68]|0-k[65]|0),D(p),void requestAnimationFrame(G))},S=new AudioContext,v=S.createOscillator(),v.connect(S.destination),v.start(0),G(),onkeydown=function(e){k[e.keyCode]=1},onkeyup=function(e){k[e.keyCode]=0},onmousemove=function(e){X=e.layerX/9,Y=e.layerY/9},onmousedown=function(){++mb},onmouseup=function(){--mb};