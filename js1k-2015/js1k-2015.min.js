g=null,c.t=c.fillText,MT=Math,ab=MT.abs,R=MT.random,N=Date.now,c.scale(9,9),cc=c.canvas,W=cc.width/9,H=cc.height/9,k=[],t=[],e=[],mb=mx=my=0,no=function(n,c,o,e,t){return{x:n||R()*W,y:c||R()*H,a:o||0,c:e||0,e:t||0}},p=no(W/2,H/2,g,"#0f0"),p.h=50,ud=function(n,o){n.e?(R()<.05&&(n.a=fm(n,p)),t.forEach(function(c){co(c,n)&&e.splice(o,1)}),co(p,n)&&p.h--):(W-n.x<1||H-n.y<1)&&t.splice(o,1),n.a&&(n.x-=MT.cos(n.a),n.y-=MT.sin(n.a)),c.fillStyle=n.c,c.fillRect(n.x,n.y,1,1)},fm=function(n,c){return MT.atan2(n.y-c.y,n.x-c.x)},co=function(n,c){return ab(n.x-c.x)+ab(n.y-c.y)<2},gl=function(){c.clearRect(0,0,W,H),N()%100<1&&e.push(no(g,g,g,"red",1)),e.forEach(ud),p.h<1||(p.y+=.5*(k[83]|0-k[87]|0),p.x+=.5*(k[68]|0-k[65]|0),ud(p),mb&&R()>.8&&t.push(no(p.x,p.y,fm(p,no(mx,my)),"#993",0)),t.forEach(ud),requestAnimationFrame(gl))},gl(),b.onkeydown=function(n){k[n.keyCode]=1},b.onkeyup=function(n){k[n.keyCode]=0},b.onmousemove=function(n){mx=n.layerX/9,my=n.layerY/9},b.onmousedown=function(){++mb},b.onmouseup=function(){--mb};