with(g=null,M=Math,ab=M.abs,R=M.random,N=Date.now,c.scale(9,9),c.canvas)W=width/9,H=height/9;k=[],t=[],e=[],j=z=mb=mx=my=0,no=function(n,o,e,c,t){return{x:n||R()*W,y:o||R()*H,a:e||0,c:c||0,e:t||0}},p=no(W/2,H/2,g,"#0f0"),p.h=50,ud=function(n,o){n.e?(R()<.05&&(n.a=fm(n,p)),t.forEach(function(c){co(c,n)&&(console.log("i:"+o+"\nlen:"+e.lenght),e.splice(o,1),z++,j="#2a2")}),co(p,n)&&(p.h--,j="red")):(W-n.x<1||H-n.y<1)&&t.splice(o,1),n.a&&(n.x-=M.cos(n.a),n.y-=M.sin(n.a)),c.fillStyle=n.c,c.fillRect(n.x,n.y,1,1)},fm=function(n,o){return M.atan2(n.y-o.y,n.x-o.x)},co=function(n,o){return ab(n.x-o.x)+ab(n.y-o.y)<2},gl=function(){c.fillStyle=j,c.fillRect(0,0,W,H),j="#fff",N()%70<1&&e.push(no(g,g,g,"red",1)),e.forEach(ud),c.fillStyle="#000",c.fillText("kills:"+z+" hp:"+p.h,0,9),p.h<1||(p.y+=.5*(k[83]|0-k[87]|0),p.x+=.5*(k[68]|0-k[65]|0),ud(p),mb&&R()>.8&&t.push(no(p.x,p.y,fm(p,no(mx,my)),"#993",0)),t.forEach(ud),requestAnimationFrame(gl))},gl(),b.onkeydown=function(n){k[n.keyCode]=1},b.onkeyup=function(n){k[n.keyCode]=0},b.onmousemove=function(n){mx=n.layerX/9,my=n.layerY/9},b.onmousedown=function(){++mb},b.onmouseup=function(){--mb};