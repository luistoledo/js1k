with(ac=new AudioContext,v=ac.createOscillator(),v.connect(ac.destination),v.start(),b.style.cursor=crosshair,g=null,M=Math,ab=M.abs,R=M.random,N=Date.now,c.scale(9,9),c.canvas)W=width/9,H=height/9;k=[],t=[],e=[],f=j=z=mb=mx=my=0,no=function(n,e,o,t,c){return{x:n||R()*W,y:e||R()*H,a:o||0,c:t||0,e:c||0}},p=no(W/2,H/2,g,"#0f0"),p.h=10,ud=function(n,o){n.e?(R()<.05&&(n.a=fm(n,p)),t.forEach(function(t){co(t,n)&&(e.splice(o,1),z++,j="#fff",f=300)}),co(p,n)&&(p.h--,j="red",f=400)):(W-n.x<1||H-n.y<1)&&t.splice(o,1),n.a&&(n.x-=M.cos(n.a),n.y-=M.sin(n.a)),c.fillStyle=n.c,c.fillRect(n.x,n.y,1,1)},fm=function(n,e){return M.atan2(n.y-e.y,n.x-e.x)},co=function(n,e){return ab(n.x-e.x)+ab(n.y-e.y)<2},gl=function(){return c.fillStyle=j,c.fillRect(0,0,W,H),j="#fde",v.frequency.setValueAtTime(f,ac.currentTime),f=0,N()%60<1&&e.push(no(g,g,g,"red",1)),e.forEach(ud),c.fillStyle="#000",c.fillText("k:"+z+" h:"+p.h,0,9),p.h<1?void v.stop():(p.y+=.5*(k[83]|0-k[87]|0),p.x+=.5*(k[68]|0-k[65]|0),ud(p),mb&&R()>.8&&(t.push(no(p.x,p.y,fm(p,no(mx,my)),"#993",0)),f=200),t.forEach(ud),void requestAnimationFrame(gl))},gl(),b.onkeydown=function(n){k[n.keyCode]=1},b.onkeyup=function(n){k[n.keyCode]=0},b.onmousemove=function(n){mx=n.layerX/9,my=n.layerY/9},b.onmousedown=function(){++mb},b.onmouseup=function(){--mb};